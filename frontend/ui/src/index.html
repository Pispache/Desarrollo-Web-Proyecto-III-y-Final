<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Marcador</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Favicon/Icons -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <script>
    (function () {
      try {
        var smallHref = 'favicon.ico';
        var bigHref = 'assets/favicon-64.png';

        function setFavicon(href, sizes, type) {
          document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]').forEach(function (el) {
            el.parentNode.removeChild(el);
          });
          var link = document.createElement('link');
          link.rel = 'icon';
          if (type) link.type = type;
          if (sizes) link.sizes = sizes;
          link.href = href;
          document.head.appendChild(link);
        }

        if (document.readyState !== 'complete') {
          setFavicon(bigHref, '64x64', 'image/png');
        }
        window.addEventListener('load', function () {
          setFavicon(smallHref, '', 'image/x-icon');
        });
        document.addEventListener('readystatechange', function () {
          if (document.readyState === 'complete') {
            setFavicon(smallHref, '', 'image/x-icon');
          } else {
            setFavicon(bigHref, '64x64', 'image/png');
          }
        });
      } catch (e) { /* noop */ }
    })();
  </script>
  <meta name="theme-color" content="#0b1428">
  <script>
    (function() {
      try {
        var KEY = 'ui.theme';
        var docEl = document.documentElement;
        var stored = (localStorage.getItem(KEY) || '').toLowerCase();
        var theme = stored === 'light' || stored === 'dark' ? stored : null;
        if (!theme) {
          try {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
              theme = 'light';
            }
          } catch (e) {}
        }
        if (theme === 'light') {
          docEl.setAttribute('data-theme', 'light');
          docEl.setAttribute('data-bs-theme', 'light');
        } else {
          docEl.removeAttribute('data-theme');
          docEl.setAttribute('data-bs-theme', 'dark');
        }
      } catch (e) {}
    })();
  </script>
  <script>
    (function() {
      function onAuthPage() {
        try {
          var p = (location && location.pathname) || '';
          return p.indexOf('/login') !== -1 || p.indexOf('/registro') !== -1;
        } catch { return false; }
      }
      function enforceAuthPageState() {
        if (onAuthPage()) {
          try { document.body.classList.add('auth-page'); } catch {}
          try {
            // Limpia cualquier rastro de sesión por si el navegador restauró desde caché
            localStorage.removeItem('auth.token');
            localStorage.removeItem('auth.expiresAt');
            localStorage.removeItem('auth.user');
          } catch {}
        } else {
          try { document.body.classList.remove('auth-page'); } catch {}
        }
      }
      window.addEventListener('DOMContentLoaded', enforceAuthPageState, { once: true });
      window.addEventListener('pageshow', enforceAuthPageState);
    })();
  </script>
</head>
<body>
  <app-root></app-root>
</body>
</html>
